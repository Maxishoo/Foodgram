# 🍽️ Фудграм — Кулинарная социальная сеть

## 📖 Описание проекта

**Фудграм** — это социальная платформа для кулинаров и любителей готовить, где пользователи могут публиковать рецепты, подписываться на других авторов, добавлять рецепты в избранное и составлять списки покупок для приготовления блюд.

### Основные возможности

- 📝 **Публикация рецептов** — создавайте и редактируйте свои кулинарные шедевры
- 👥 **Подписки** — следите за любимыми авторами и получайте их новые рецепты
- ⭐ **Избранное** — сохраняйте понравившиеся рецепты для быстрого доступа
- 🛒 **Список покупок** — автоматически формируйте список ингредиентов для выбранных блюд
- 📥 **Экспорт списка покупок** — скачивайте файл с перечнем продуктов в формате .txt
- 🔐 **Аутентификация** — безопасная авторизация через токены

---

## 🛠️ Технологический стек

### Бэкенд
| Технология | Версия | Назначение |
|------------|--------|------------|
| **Python** | 3.10+ | Язык программирования |
| **Django** | 4.2+ | Веб-фреймворк |
| **Django REST Framework** | 3.14+ | API для фронтенда |
| **PostgreSQL** | 14+ | Основная база данных |
| **Gunicorn** | 21.2+ | WSGI HTTP сервер |
| **Django Token Auth** | - | Аутентификация через токены |

### Инфраструктура
| Технология | Назначение |
|------------|------------|
| **Docker** | Контейнеризация приложения |
| **Docker Compose** | Оркестрация сервисов |
| **Nginx** | Веб-сервер и реверс-прокси |

### Инструменты
| Технология | Назначение |
|------------|------------|
| **Git** | Система контроля версий |

---

## 🚀 Быстрый старт

### 1. Подготовка окружения

Создайте файл `.env` на основе примера `.env_example`:

```bash
cp .env_example .env
```

Заполните необходимые переменные окружения:
- `SECRET_KEY` — секретный ключ Django
- `DEBUG` — режим отладки (True/False)
- `DATABASE_URL` — строка подключения к базе данных
- `USE_TEST_BASE` — использовать тестовую базу (True/False)

### 2. Запуск проекта в контейнерах

```bash
# Запуск всех сервисов
sudo docker-compose -f docker-compose.yml up -d

# Выполнение миграций
sudo docker-compose -f docker-compose.yml exec backend python manage.py makemigrations
sudo docker-compose -f docker-compose.yml exec backend python manage.py migrate

# Сбор статических файлов
sudo docker-compose -f docker-compose.yml exec backend python manage.py collectstatic --noinput
sudo docker-compose -f docker-compose.yml exec backend cp -r /app/static_django/. /static_django/

# Создание суперпользователя
sudo docker-compose -f docker-compose.yml exec backend python manage.py createsuperuser
```

### 3. Доступ к приложению

После успешного запуска проект будет доступен по следующим адресам:

| Адрес | Описание |
|-------|----------|
| `127.0.0.1` | Главная страница |
| `127.0.0.1/admin/` | Панель администратора |
| `127.0.0.1/api/docs/` | Документация API |

---

## 👥 Роли пользователей и функциональность

### 📊 Матрица доступа

| Функционал | Неавторизованные | Авторизованные | Администратор |
|------------|------------------|----------------|---------------|
| **Просмотр контента** | | | |
| Главная страница | ✅ | ✅ | ✅ |
| Страница рецепта | ✅ | ✅ | ✅ |
| Форма авторизации | ✅ | ✅ | ✅ |
| Форма регистрации | ✅ | ✅ | ✅ |
| **Подписки** | | | |
| Страница «Мои подписки» | ❌ | ✅ | ✅ |
| Подписка/отписка на рецепте | ❌ | ✅ | ✅ |
| Подписка/отписка на авторе | ❌ | ✅ | ✅ |
| Рецепты авторов в подписках | ❌ | ✅ | ✅ |
| **Избранное** | | | |
| Страница «Избранное» | ❌ | ✅ | ✅ |
| Добавить/удалить в избранное (рецепт) | ❌ | ✅ | ✅ |
| Добавить/удалить в избранное (список) | ❌ | ✅ | ✅ |
| **Список покупок** | | | |
| Страница «Список покупок» | ❌ | ✅ | ✅ |
| Добавить/удалить в список покупок | ❌ | ✅ | ✅ |
| Выгрузка списка (.txt) | ❌ | ✅ | ✅ |
| Автоматический подсчёт ингредиентов | ❌ | ✅ | ✅ |
| **Управление рецептами** | | | |
| Страница «Создать рецепт» | ❌ | ✅ | ✅ |
| Публикация рецепта | ❌ | ✅ | ✅ |
| Редактирование своего рецепта | ❌ | ✅ | ✅ |
| Удаление своего рецепта | ❌ | ✅ | ✅ |
| **Профиль** | | | |
| Изменение пароля | ❌ | ✅ | ✅ |
| Выход из системы | ❌ | ✅ | ✅ |
| Восстановление пароля | ❌ | ✅ | ✅ |
| **Администрирование** | | | |
| Изменение пароля любого пользователя | ❌ | ❌ | ✅ |
| Создание/блокировка/удаление аккаунтов | ❌ | ❌ | ✅ |
| Редактирование/удаление любых рецептов | ❌ | ❌ | ✅ |
| Управление ингредиентами | ❌ | ❌ | ✅ |
| Управление тегами | ❌ | ❌ | ✅ |

---

## 🧪 Варианты запуска

### 🚀 Режим с тестовой базой данных (`USE_TEST_BASE=True`)

В этом режиме проект запускается с предзаполненной базой данных SQLite, содержащей тестовые данные и готовые аккаунты.

#### Тестовые аккаунты:

| № | Имя | Никнейм | Почта | Пароль |
|---|-----|---------|-------|--------|
| 1 | Иван Петров | `IvanTheGreat` | ivan.petrov@example.com | `Petrov123!` |
| 2 | Елена Смирнова | `LenaSmile` | elena.smirnova@testmail.com | `SmirnovaE2024` |
| 3 | Алексей Козлов | `Kozel_Alex` | alex.kozlov@demo.org | `Kozlov$$99` |
| 4 | Мария Иванова | `MashaMagic` | maria.ivanova@fakeinbox.com | `Masha12345` |
| 5 | Дмитрий Соколов | `SokolDima` | dmitry.sokolov@temp-mail.net | `Sokol!D2024` |
| 6 | Анна Кузнецова | `AnnaKuz` | anna.kuznetsova@mockbox.org | `KuzAnna!777` |
| 7 | Администратор | `admin` | admin@example.com | `admin` |

**Преимущества:**
- ✅ Быстрый старт без настройки базы данных
- ✅ Готовые данные для тестирования функционала
- ✅ Предзаполненные рецепты и ингредиенты

### 🗄️ Режим с продакшен базой (`USE_TEST_BASE=False`)

В этом режиме проект работает с полноценной базой данных PostgreSQL.

**Особенности:**
- 🗄️ Используется реляционная СУБД PostgreSQL
- 📦 В базе присутствуют только администратор и справочник ингредиентов
- 🔒 Подходит для продакшен-развертывания

---

## 📁 Структура проекта

```
foodgram/
├── docker-compose.yml              # Конфигурация сервисов
├── nginx/                          # Конфигурация Nginx
│   └── nginx.conf
├── backend/                        # Django приложение
│   ├── Dockerfile                  # Сборка бэкенда
│   ├── requirements.txt            # Python зависимости
│   ├── manage.py
│   ├── foodgram/                   # Основное приложение
│   │   ├── settings.py             # Настройки Django
│   │   ├── urls.py                 # Маршрутизация
│   │   └── wsgi.py
│   ├── apps/                       # Приложения проекта
│   │   ├── users/                  # Модуль пользователей
│   │   ├── recipes/                # Модуль рецептов
│   │   ├── subscriptions/          # Модуль подписок
│   │   ├── favorites/              # Модуль избранного
│   │   └── shopping_cart/          # Модуль списка покупок
│   ├── static_django/              # Статические файлы
│   └── media/                      # Медиа файлы (изображения)
├── .env                            # Переменные окружения
├── .env_example                    # Пример .env файла
└── README.md                       # Документация
```

---

## 🗄️ Схема базы данных

### Основные модели

```
┌─────────────────┐         ┌─────────────────┐
│     User        │         │     Recipe      │
├─────────────────┤         ├─────────────────┤
│ id              │         │ id              │
│ username        │         │ author_id ──────┼────┐
│ email           │         │ title           │    │
│ password        │         │ text            │    │
│ first_name      │         │ cooking_time    │    │
│ last_name       │         │ image           │    │
│ is_staff        │         │ created_at      │    │
│ is_active       │         │ tags            │    │
└─────────────────┘         └─────────────────┘    │
         │                           │             │
         │                           │             │
         │                           ▼             │
         │                   ┌─────────────────┐   │
         │                   │   Ingredient    │   │
         │                   ├─────────────────┤   │
         │                   │ id              │   │
         │                   │ name            │   │
         │                   │ measurement_unit│   │
         │                   └─────────────────┘   │
         │                           ▲             │
         │                           │             │
         │                   ┌───────┴─────────┐   │
         │                   │RecipeIngredient │   │
         │                   ├─────────────────┤   │
         │                   │ recipe_id       │   │
         │                   │ ingredient_id   │   │
         │                   │ amount          │   │
         │                   └─────────────────┘   │
         │                                         │
         │                                         │
         │         ┌─────────────────┐             │
         └─────────┼── Subscription  │             │
                   ├─────────────────┤             │
                   │ user_id         │             │
                   │ author_id       │             │
                   └─────────────────┘             │
                                                   │
                   ┌─────────────────┐             │
                   │    Favorite     │             │
                   ├─────────────────┤             │
                   │ user_id         │             │
                   │ recipe_id       │             │
                   └─────────────────┘             │
                                                   │
                   ┌─────────────────┐             │
                   │  ShoppingCart   │             │
                   ├─────────────────┤             │
                   │ user_id         │             │
                   │ recipe_id       │             │
                   └─────────────────┘             │
                                                   │
                   ┌─────────────────┐             │
                   │      Tag        │             │
                   ├─────────────────┤             │
                   │ id              │             │
                   │ name            │             │
                   │ color           │             │
                   │ slug            │             │
                   └─────────────────┘             │
                                                   │
                   ┌─────────────────┐             │
                   │ RecipeTag       │             │
                   ├─────────────────┤             │
                   │ recipe_id ──────┤             │
                   │ tag_id          │             │
                   └─────────────────┘
```
